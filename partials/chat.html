<link rel="stylesheet" href="./assets/design.css">
<link rel="stylesheet" href="./assets/style.css">

<!-- 1) Prepare global plans -->
<script>
  window.__PLANS__ = [];
</script>

<!-- 2) Load plans -->
<script type="module">
  const res = await fetch("./data/plans.json");
  window.__PLANS__ = await res.json();
</script>

<!-- 3) Offer renderer -->
<script src="./assets/offers.js"></script>

<!-- 4) Chat logic -->
<script src="./assets/chat.js"></script>

<!-- TOGGLE (JS LISTENS TO THIS) -->
<button id="chat-toggle" class="adeala-btn chat-toggle-btn">
  Dealett-AI
</button>

<!-- CHAT ROOT (NEVER TOGGLED) -->
<div
  id="dealett-chat"
  data-chat-root
  class="chat-container"
  role="complementary"
  lang="sv"
>

  <!-- CHAT PANEL (JS TOGGLES .closed HERE) -->
  <div
    id="chat-panel"
    class="chat-box closed"
    aria-live="polite"
  >

    <!-- HEADER -->
    <div class="chat-box-header">
      <h2>Dealett-AI</h2>

      <div class="chat-box-actions">
        <button
          id="chat-reset"
          type="button"
          aria-label="Starta fräscht"
        >⟳</button>

        <button
          id="chat-close"
          type="button"
          aria-label="Stäng chatt"
        >✕</button>
      </div>
    </div>

    <!-- SYSTEM NOTICE -->
    <div class="chat-notice" role="alert">
      <p>
        Vi bryr oss om din integritet. Genom att starta chatten godkänner du våra villkor.
      </p>
      <button aria-label="Stäng meddelande">✕</button>
    </div>

    <!-- BODY -->
    <div id="chat-body-container" class="chat-body">
      <div
        id="chat-messages"
        class="chat-log"
        role="log"
        aria-live="polite"
      ></div>
    </div>

    <!-- COMPOSER -->
    <form id="chat-form" class="chat-composer" autocomplete="off">
      <textarea
        id="chat-input"
        name="message"
        placeholder="Ställ mig en fråga…"
        rows="1"
        enterkeyhint="send"
      ></textarea>

      <button type="submit" aria-label="Skicka">➤</button>
    </form>

  </div>
</div>